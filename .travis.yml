language: ruby
script: bundle exec middleman build
env:
  global:
    - GIT_COMMITTER_NAME='suzuryo@travis-ci'
    - GIT_COMMITTER_EMAIL='suzuryo@gmail.com'
    - GIT_AUTHOR_NAME='suzuryo@travis-ci'
    - GIT_AUTHOR_EMAIL='suzuryo@gmail.com'
    - secure: "ZoLgsAKEc7NfvNjEcnylvHovsK+OOUQISu6HDXsI0JudG8+jl34G+80pXqqARzD3R/FY/7Kzak/4vmsVBMrEQiEXjoaB3cQ5lC+1X0GYDAFaRpDL62K8w5NBAh+BWVA1SxaH3OsZ+j8y8omooSEqKJBW0GDI/mIKd03DpXv30lA="
after_success:
  - echo -e "Host github.com\n\tStrictHostKeyChecking no\nIdentityFile ~/.ssh/deploy.key\n" >> ~/.ssh/config
  - openssl aes-256-cbc -k "$SERVER_KEY" -in .travis/deploy_key.enc -d -a -out deploy.key
  - cp deploy.key ~/.ssh/
  - chmod 600 ~/.ssh/deploy.key
  - git remote add iwdd.github.io git@github.com:IWDD/iwdd.github.io.git
  - '[ "$TRAVIS_BRANCH" == "master" ] && bundle exec middleman deploy'
